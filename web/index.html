<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Real World Probability MVP</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 24px; }
    .card { border: 1px solid #ddd; border-radius: 10px; padding: 14px; margin-bottom: 12px; }
    button { padding: 8px 12px; cursor: pointer; }
    pre { background: #f6f6f6; padding: 12px; overflow: auto; }
  </style>
</head>
<body>
  <h1>Real World Probability — MVP</h1>
  <p>Pipeline: mispricing → signal score → risk gate → executive summary PDF.</p>

  <h2>Opportunities</h2>
  <div id="list"></div>

  <h2>Result</h2>
  <pre id="result">No action yet.</pre>

  <script>
    async function load() {
      const res = await fetch('/api/opportunities');
      const data = await res.json();
      const list = document.getElementById('list');
      list.innerHTML = '';
      data.forEach((o) => {
        const div = document.createElement('div');
        div.className = 'card';
        div.innerHTML = `
          <b>${o.market}</b><br/>
          Side: ${o.side} | Edge: ${o.edgePct}% | Signal: <b>${o.signalScore}</b><br/>
          <small>${o.thesis}</small><br/><br/>
          <button>Create Position Summary</button>
        `;
        div.querySelector('button').onclick = async () => {
          const r = await fetch('/api/position/create', {
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify({...o, bankrollUsd: 1000, maxRiskPerTradePct: 1})
          });
          const out = await r.json();
          document.getElementById('result').textContent = JSON.stringify(out, null, 2);
        };
        list.appendChild(div);
      });
    }
    load();
  </script>
</body>
</html>